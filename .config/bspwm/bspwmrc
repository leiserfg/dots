#!/usr/bin/sh
export SXHKD_SHELL=/usr/bin/sh
bspc monitor -d ₁ ₂ ₃ ₄ ₅    
bspc config window_gap 6
bspc config border_width         3
bspc config focused_border_color  '#afcfee'
bspc config presel_feedback_color  '#afcfee'
bspc config split_ratio          0.52
bspc config borderless_monocle   true
bspc config gapless_monocle      true
bspc config single_monocle  true

# remove all rules first
bspc rule -r '*:*'
# bspc rule -a "Brave-browser" desktop='^1' follow=on
bspc rule -a "*:Navigator" desktop='^1' follow=on
bspc rule -a "TelegramDesktop" desktop='^4' follow=on
# bspc rule -a Screenkey manage=off
bspc rule -a Zathura state=tiled
bspc rule -a PureRef state=floating
bspc rule -a gmic_qt  follow=on focus=on state=floating
bspc rule -a Pavucontrol state=floating
bspc rule -a Dragon-drag-and-drop sticky=on

#Don't run if it's running
run_disowned () {
    nohup "$@" > /dev/null 2>&1 &
}

run_once () {
    pidof "$(basename $1)" || run_disowned "$@"
}

#Those operation are idempotent

# Reload sxhkd manually cause using USR1 hangs the keyboard frome time to time
pkill sxhkd
run_disowned sxhkd


~/.config/polybar/launch.sh > /dev/null 2>&1 &
pkill compton; compton -b
nitrogen --restore
xset s 120 180
fix_xcursor

run_once pulseaudio --start
run_once telegram-desktop
run_once xss-lock -n dim-screen.sh -- i3lock-fancy-rapid 5 pixel
run_once /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1
run_once unclutter -b

